<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–®–∞—Ö–º–∞—Ç—ã</title>
    <style>
        table {
            border-collapse: collapse;
        }
        td {
            width: 50px;
            height: 50px;
            text-align: center;
            vertical-align: middle;
            font-size: 24px;
        }
        .black {
            background-color: #3b3b3b;
        }
        .white {
            background-color: #f0d9b5;
        }
    </style>
</head>
<body>
    <h1>–®–∞—Ö–º–∞—Ç—ã</h1>
    <table id="chessboard"></table>
    <p>–í–≤–µ–¥–∏—Ç–µ —Ö–æ–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "e2 e4" –∏–ª–∏ "e3 e7" –¥–ª—è —Å—Ç—Ä–µ–ª—å–±—ã):</p>
    <input type="text" id="moveInput" onkeypress="handleKeyPress(event)">

    <script>
        const SIZE = 8;             
        const EMPTY = ' ';          
        const PAWN_WHITE = '‚ôô';    
        const PAWN_BLACK = '‚ôü';    
        const ROOK_WHITE = '‚ôñ';    
        const ROOK_BLACK = '‚ôú';    
        const KNIGHT_WHITE = '‚ôò';  
        const KNIGHT_BLACK = '‚ôû';  
        const BISHOP_WHITE = '‚ôó';  
        const BISHOP_BLACK = '‚ôù';  
        const QUEEN_WHITE = '‚ôï';   
        const QUEEN_BLACK = '‚ôõ';   
        const KING_WHITE = '‚ôî';    
        const KING_BLACK = '‚ôö';    
        const STRELOK_WHITE = 'üèπ'; // –°—Ç—Ä–µ–ª–æ–∫ –¥–ª—è –±–µ–ª—ã—Ö
        const STRELOK_BLACK = 'üèπ'; // –°—Ç—Ä–µ–ª–æ–∫ –¥–ª—è —á–µ—Ä–Ω—ã—Ö

        let board = [
            [ROOK_BLACK, KNIGHT_BLACK, STRELOK_BLACK, QUEEN_BLACK, KING_BLACK, BISHOP_BLACK, KNIGHT_BLACK, ROOK_BLACK],
            [PAWN_BLACK, PAWN_BLACK, PAWN_BLACK, PAWN_BLACK, PAWN_BLACK, PAWN_BLACK, PAWN_BLACK, PAWN_BLACK],
            [' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
            [' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
            [' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
            [' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
            [PAWN_WHITE, PAWN_WHITE, PAWN_WHITE, PAWN_WHITE, PAWN_WHITE, PAWN_WHITE, PAWN_WHITE, PAWN_WHITE],
            [ROOK_WHITE, KNIGHT_WHITE, STRELOK_WHITE, QUEEN_WHITE, KING_WHITE, BISHOP_WHITE, KNIGHT_WHITE, ROOK_WHITE],
        ];

        let strelokCanShoot = {
            white: true,
            black: true
        };

        function drawBoard() {
            const table = document.getElementById('chessboard');
            table.innerHTML = '';
            for (let row = 0; row < SIZE; row++) {
                const tr = document.createElement('tr');
                for (let col = 0; col < SIZE; col++) {
                    const td = document.createElement('td');
                    td.className = (row + col) % 2 === 0 ? 'white' : 'black';
                    td.innerText = board[row][col];
                    tr.appendChild(td);
                }
                table.appendChild(tr);
            }
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                makeMove();
                event.target.value = ''; // –û—á–∏—Å—Ç–∫–∞ –ø–æ–ª—è –≤–≤–æ–¥–∞ –ø–æ—Å–ª–µ —Ö–æ–¥–∞
            }
        }

        function makeMove() {
            const input = document.getElementById('moveInput').value;
            const [start, end] = input.split(' ');

            if (start.length !== 2 || end.length !== 2) {
                alert('–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ "e2 e4".');
                return;
            }

            const startRow = 8 - parseInt(start[1]);
            const startCol = start[0].charCodeAt(0) - 'a'.charCodeAt(0);
            const endRow = 8 - parseInt(end[1]);
            const endCol = end[0].charCodeAt(0) - 'a'.charCodeAt(0);

            if (isMoveValid(startRow, startCol, endRow, endCol)) {
                // –ï—Å–ª–∏ —ç—Ç–æ —Å—Ç—Ä–µ–ª–æ–∫ –∏ –æ–Ω —Å—Ç—Ä–µ–ª—è–µ—Ç
                if (board[startRow][startCol] === STRELOK_WHITE || board[startRow][startCol] === STRELOK_BLACK) {
                    if (startRow !== endRow && startCol !== endCol && Math.abs(startRow - endRow) > 1 && Math.abs(startCol - endCol) > 1) {
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Ñ–∏–≥—É—Ä–∞ –¥–ª—è —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏—è
                        if (board[endRow][endCol] !== EMPTY) {
                            board[endRow][endCol] = EMPTY; // –£–Ω–∏—á—Ç–æ–∂–∞–µ–º —Ñ–∏–≥—É—Ä—É
                            strelokCanShoot[board[startRow][startCol] === STRELOK_WHITE ? 'white' : 'black'] = false; // –°—Ç—Ä–µ–ª–æ–∫ –Ω–µ –º–æ–∂–µ—Ç —Å—Ç—Ä–µ–ª—è—Ç—å —Å–Ω–æ–≤–∞
                        }
                    } else {
                        alert('–°—Ç—Ä–µ–ª–æ–∫ –Ω–µ –º–æ–∂–µ—Ç —Å—Ç—Ä–µ–ª—è—Ç—å –≤ —Ä–∞–¥–∏—É—Å–µ –æ–¥–Ω–æ–π –∫–ª–µ—Ç–∫–∏.');
                        return;
                    }
                }

                // –ï—Å–ª–∏ —Å—Ç—Ä–µ–ª–æ–∫ –ø–µ—Ä–µ–∑–∞—Ä—è–∂–∞–µ—Ç—Å—è
                if (!strelokCanShoot[board[startRow][startCol] === STRELOK_WHITE ? 'white' : 'black']) {
                    board[startRow][startCol] = EMPTY; // –£–±–∏—Ä–∞–µ–º —Å—Ç—Ä–µ–ª–∫–∞ —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–π –ø–æ–∑–∏—Ü–∏–∏
                    board[endRow][endCol] = board[startRow][startCol]; // –ü–µ—Ä–µ–º–µ—â–∞–µ–º —Å—Ç—Ä–µ–ª–∫–∞
                    strelokCanShoot[board[startRow][startCol] === STRELOK_WHITE ? 'white' : 'black'] = true; // –¢–µ–ø–µ—Ä—å —Å—Ç—Ä–µ–ª–æ–∫ –º–æ–∂–µ—Ç —Å—Ç—Ä–µ–ª—è—Ç—å —Å–Ω–æ–≤–∞
                } else {
                    board[endRow][endCol] = board[startRow][startCol]; // –ü–µ—Ä–µ–º–µ—â–∞–µ–º —Å—Ç—Ä–µ–ª–∫–∞
                    board[startRow][startCol] = EMPTY; // –£–±–∏—Ä–∞–µ–º —Å—Ç—Ä–µ–ª–∫–∞ —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–π –ø–æ–∑–∏—Ü–∏–∏
                }

                drawBoard();
            } else {
                alert('–ù–µ–≤–µ—Ä–Ω—ã–π —Ö–æ–¥.');
            }
        }

        function isMoveValid(startRow, startCol, endRow, endCol) {
            const piece = board[startRow][startCol];
            if (piece === EMPTY) {
                return false; // –ù–µ—Ç —Ñ–∏–≥—É—Ä—ã –Ω–∞ —Å—Ç–∞—Ä–æ–π –ø–æ–∑–∏—Ü–∏–∏
            }

            // –õ–æ–≥–∏–∫–∞ –¥–ª—è —Å—Ç—Ä–µ–ª–∫–∞
            if (piece === STRELOK_WHITE || piece === STRELOK_BLACK) {
                const isShooting = board[endRow][endCol] !== EMPTY && startRow !== endRow && startCol !== endCol;
                const isMove = Math.abs(startRow - endRow) <= 1 && Math.abs(startCol - endCol) <= 1;
                return isShooting || isMove; // –°—Ç—Ä–µ–ª–æ–∫ –º–æ–∂–µ—Ç —Å—Ç—Ä–µ–ª—è—Ç—å –∏–ª–∏ –¥–≤–∏–≥–∞—Ç—å—Å—è
            }

            // –õ–æ–≥–∏–∫–∞ –¥–ª—è –ø–µ—à–∫–∏
            if (piece === PAWN_WHITE) {
                if (startCol === endCol) {
                    if (startRow === 6 && endRow === 4) return board[5][startCol] === EMPTY && board[endRow][endCol] === EMPTY; // –î–≤–æ–π–Ω–æ–π —à–∞–≥
                    return endRow === startRow - 1 && board[endRow][endCol] === EMPTY; // –û–±—ã—á–Ω—ã–π —à–∞–≥
                }
                return (endRow === startRow - 1 && Math.abs(endCol - startCol) === 1 && board[endRow][endCol] !== EMPTY); // –£–¥–∞—Ä
            }
            if (piece === PAWN_BLACK) {
                if (startCol === endCol) {
                    if (startRow === 1 && endRow === 3) return board[2][startCol] === EMPTY && board[endRow][endCol] === EMPTY; // –î–≤–æ–π–Ω–æ–π —à–∞–≥
                    return endRow === startRow + 1 && board[endRow][endCol] === EMPTY; // –û–±—ã—á–Ω—ã–π —à–∞–≥
                }
                return (endRow === startRow + 1 && Math.abs(endCol - startCol) === 1 && board[endRow][endCol] !== EMPTY); // –£–¥–∞—Ä
            }

            // –õ–æ–≥–∏–∫–∞ –¥–ª—è –ª–∞–¥—å–∏
            if (piece === ROOK_WHITE || piece === ROOK_BLACK) {
                if (startRow === endRow) {
                    for (let i = Math.min(startCol, endCol) + 1; i < Math.max(startCol, endCol); i++) {
                        if (board[startRow][i] !== EMPTY) return false; // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è
                    }
                    return true;
                }
                if (startCol === endCol) {
                    for (let i = Math.min(startRow, endRow) + 1; i < Math.max(startRow, endRow); i++) {
                        if (board[i][startCol] !== EMPTY) return false; // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è
                    }
                    return true;
                }
                return false;
            }

            // –õ–æ–≥–∏–∫–∞ –¥–ª—è –∫–æ–Ω—è
            if (piece === KNIGHT_WHITE || piece === KNIGHT_BLACK) {
                return (Math.abs(startRow - endRow) === 2 && Math.abs(startCol - endCol) === 1) || 
                       (Math.abs(startRow - endRow) === 1 && Math.abs(startCol - endCol) === 2);
            }

            // –õ–æ–≥–∏–∫–∞ –¥–ª—è —Å–ª–æ–Ω–∞
            if (piece === BISHOP_WHITE || piece === BISHOP_BLACK) {
                if (Math.abs(startRow - endRow) === Math.abs(startCol - endCol)) {
                    const rowIncrement = (endRow > startRow) ? 1 : -1;
                    const colIncrement = (endCol > startCol) ? 1 : -1;
                    let r = startRow + rowIncrement;
                    let c = startCol + colIncrement;
                    while (r !== endRow && c !== endCol) {
                        if (board[r][c] !== EMPTY) return false; // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è
                        r += rowIncrement;
                        c += colIncrement;
                    }
                    return true;
                }
                return false;
            }

            // –õ–æ–≥–∏–∫–∞ –¥–ª—è —Ñ–µ—Ä–∑—è
            if (piece === QUEEN_WHITE || piece === QUEEN_BLACK) {
                if (startRow === endRow || startCol === endCol) {
                    // –õ–æ–≥–∏–∫–∞ –∫–∞–∫ —É –ª–∞–¥—å–∏
                    return isMoveValid(startRow, startCol, endRow, endCol); // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–≥–∏–∫—É –¥–ª—è –ª–∞–¥—å–∏
                } else if (Math.abs(startRow - endRow) === Math.abs(startCol - endCol)) {
                    // –õ–æ–≥–∏–∫–∞ –∫–∞–∫ —É —Å–ª–æ–Ω–∞
                    return isMoveValid(startRow, startCol, endRow, endCol); // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–≥–∏–∫—É –¥–ª—è —Å–ª–æ–Ω–∞
                }
                return false;
            }

            // –õ–æ–≥–∏–∫–∞ –¥–ª—è –∫–æ—Ä–æ–ª—è
            if (piece === KING_WHITE || piece === KING_BLACK) {
                return Math.abs(startRow - endRow) <= 1 && Math.abs(startCol - endCol) <= 1; // –ö–æ—Ä–æ–ª—å —Ö–æ–¥–∏—Ç –Ω–∞ 1 –∫–ª–µ—Ç–∫—É
            }

            return false; // –ù–µ –¥–æ–ø—É—Å—Ç–∏–º—ã–π —Ö–æ–¥
        }

        drawBoard();
    </script>
</body>
</html>
